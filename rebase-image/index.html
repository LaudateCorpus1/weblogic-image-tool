<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.82.0" />
    <meta name="description" content="">


    <link rel="icon" href="/weblogic-image-tool/images/favicon.png" type="image/png">

    <title> :: WebLogic Image Tool</title>

    
    <link href="/weblogic-image-tool/css/nucleus.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/fontawesome-all.min.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/hybrid.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/featherlight.min.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/perfect-scrollbar.min.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/auto-complete.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/atom-one-dark-reasonable.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/theme.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/tabs.css?1619704376" rel="stylesheet">
    <link href="/weblogic-image-tool/css/hugo-theme.css?1619704376" rel="stylesheet">
    
    

    <script src="/weblogic-image-tool/js/jquery-3.3.1.min.js?1619704376"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/weblogic-image-tool/rebase-image/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://oracle.github.io/weblogic-image-tool">
  <img src="https://oracle.github.io/weblogic-image-tool/images/logo.png" height="60"><br/>
  Image Tool
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/weblogic-image-tool/js/lunr.min.js?1619704376"></script>
<script type="text/javascript" src="/weblogic-image-tool/js/auto-complete.js?1619704376"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/oracle.github.io\/weblogic-image-tool";
    
</script>
<script type="text/javascript" src="/weblogic-image-tool/js/search.js?1619704376"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">
      <li><a  class="padding" href="https://oracle.github.io/weblogic-image-tool">Home</a></li>
        
          
        
      <li><a  class="padding" href="https://oracle.github.io/weblogic-image-tool/release-notes">Release Notes</a></li>
    </ul>

    
    

    
    <section id="footer">
      <p>Created with <i class="fas fa-heart"></i> from <a href="https://www.oracle.com">Oracle</a></p>
<p>&nbsp</p>
<p><a href="https://github.com/oracle/weblogic-image-tool"><i class="fab fa-github"></i> GitHub repo</a></p>
<p><a href="https://weblogic-slack-inviter.herokuapp.com/"><i class="fab fa-slack"></i> Public Slack #weblogic</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/weblogic-image-tool/'></a> > 
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#additional-information">Additional information</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#usage-scenarios">Usage scenarios</a></li>
    <li><a href="#copyright">Copyright</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              
            </h1>
          

        


<h1 id="rebase-image">Rebase Image</h1>
<p>The <code>rebase</code> command creates a new Docker image and copies an existing WebLogic domain to that new image.<br>
The new Docker image can be based on an existing image in the repository or created as part of the rebase operation
similar to the <code>create</code> command.</p>
<pre><code>Usage: imagetool rebase [OPTIONS]
</code></pre><table>
<thead>
<tr>
<th>Parameter</th>
<th>Definition</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--additionalBuildCommands</code></td>
<td>Path to a file with additional build commands. For more details, see <a href="#additional-information">Additional information</a>.</td>
<td></td>
</tr>
<tr>
<td><code>--additionalBuildFiles</code></td>
<td>Additional files that are required by your <code>additionalBuildCommands</code>.  A comma separated list of files that should be copied to the build context.</td>
<td></td>
</tr>
<tr>
<td><code>--buildNetwork</code></td>
<td>Networking mode for the RUN instructions during the image build.  See <code>--network</code> for Docker <code>build</code>.</td>
<td></td>
</tr>
<tr>
<td><code>--chown</code></td>
<td><code>userid:groupid</code> for JDK/Middleware installs and patches.</td>
<td><code>oracle:oracle</code></td>
</tr>
<tr>
<td><code>--docker</code></td>
<td>Path to the Docker executable.</td>
<td><code>docker</code></td>
</tr>
<tr>
<td><code>--dryRun</code></td>
<td>Skip Docker build execution and print the Dockerfile to stdout.</td>
<td></td>
</tr>
<tr>
<td><code>--fromImage</code></td>
<td>Docker image to use as a base image when creating a new image.</td>
<td><code>ghcr.io/oracle/oraclelinux:7-slim</code></td>
</tr>
<tr>
<td><code>--httpProxyUrl</code></td>
<td>Proxy for the HTTP protocol. Example: <code>http://myproxy:80</code> or <code>http:user:passwd@myproxy:8080</code></td>
<td></td>
</tr>
<tr>
<td><code>--httpsProxyUrl</code></td>
<td>Proxy for the HTTPS protocol. Example: <code>https://myproxy:80</code> or <code>https:user:passwd@myproxy:8080</code></td>
<td></td>
</tr>
<tr>
<td><code>--installerResponseFile</code></td>
<td>One or more custom response files. A comma separated list of paths to installer response files. Overrides the default responses for the Oracle silent installer.</td>
<td></td>
</tr>
<tr>
<td><code>--inventoryPointerFile</code></td>
<td>Path to custom inventory pointer file.</td>
<td></td>
</tr>
<tr>
<td><code>--inventoryPointerInstallLoc</code></td>
<td>Target location for the inventory pointer file.</td>
<td></td>
</tr>
<tr>
<td><code>--jdkVersion</code></td>
<td>Version of the server JDK to install.</td>
<td><code>8u202</code></td>
</tr>
<tr>
<td><code>--latestPSU</code></td>
<td>Find and apply the latest PatchSet Update.</td>
<td></td>
</tr>
<tr>
<td><code>--recommendedPatches</code></td>
<td>Find and apply the latest PatchSet Update and recommended patches. This takes precedence over &ndash;latestPSU</td>
<td></td>
</tr>
<tr>
<td><code>--opatchBugNumber</code></td>
<td>The patch number for OPatch (patching OPatch).</td>
<td></td>
</tr>
<tr>
<td><code>--packageManager</code></td>
<td>Override the default package manager for the base image&rsquo;s operating system. Supported values: <code>APK</code>, <code>APTGET</code>, <code>NONE</code>, <code>OS_DEFAULT</code>, <code>YUM</code>, <code>ZYPPER</code></td>
<td><code>OS_DEFAULT</code></td>
</tr>
<tr>
<td><code>--password</code></td>
<td>Request password for the Oracle Support <code>--user</code> on STDIN, see <code>--user</code>.</td>
<td></td>
</tr>
<tr>
<td><code>--passwordEnv</code></td>
<td>Environment variable containing the Oracle Support password, see <code>--user</code>.</td>
<td></td>
</tr>
<tr>
<td><code>--passwordFile</code></td>
<td>Path to a file containing just the Oracle Support password, see <code>--user</code>.</td>
<td></td>
</tr>
<tr>
<td><code>--patches</code></td>
<td>Comma separated list of patch IDs. Example: <code>12345678,87654321</code></td>
<td></td>
</tr>
<tr>
<td><code>--pull</code></td>
<td>Always attempt to pull a newer version of base images during the build.</td>
<td></td>
</tr>
<tr>
<td><code>--sourceImage</code></td>
<td>(Required) Source Image containing the WebLogic domain.</td>
<td></td>
</tr>
<tr>
<td><code>--strictPatchOrdering</code></td>
<td>Instruct OPatch to apply patches one at a time (uses <code>apply</code> instead of <code>napply</code>).</td>
<td></td>
</tr>
<tr>
<td><code>--tag</code></td>
<td>(Required) Tag for the final build image. Example: <code>store/oracle/weblogic:12.2.1.3.0</code></td>
<td></td>
</tr>
<tr>
<td><code>--targetImage</code></td>
<td>Docker image to extend for the domain&rsquo;s new image.</td>
<td></td>
</tr>
<tr>
<td><code>--type</code></td>
<td>Installer type. Supported values: <code>WLS</code>, <code>WLSDEV</code>, <code>WLSSLIM</code>, <code>FMW</code>, <code>IDM</code>, <code>OSB</code>, <code>OUD_WLS</code>, <code>SOA_OSB</code>, <code>SOA_OSB_B2B</code>, <code>WCP</code>, <code>OAM</code>, <code>OIG</code>, <code>OUD</code>, <code>SOA</code>, <code>WCC</code>, <code>WCS</code>, <code>WCP</code></td>
<td><code>WLS</code></td>
</tr>
<tr>
<td><code>--user</code></td>
<td>Your Oracle support email ID.</td>
<td></td>
</tr>
<tr>
<td><code>--version</code></td>
<td>Installer version.</td>
<td><code>12.2.1.3.0</code></td>
</tr>
</tbody>
</table>
<h2 id="additional-information">Additional information</h2>
<h4 id="--additionalbuildcommands"><code>--additionalBuildCommands</code></h4>
<p>This is an advanced option that let&rsquo;s you provide additional commands to the Docker build step.<br>
The input for this parameter is a simple text file that contains one or more of the valid sections. Valid sections for rebase:</p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Build Stage</th>
<th>Timing</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>before-jdk-install</code></td>
<td>Intermediate (JDK_BUILD)</td>
<td>Before the JDK is installed.</td>
</tr>
<tr>
<td><code>after-jdk-install</code></td>
<td>Intermediate (JDK_BUILD)</td>
<td>After the JDK is installed.</td>
</tr>
<tr>
<td><code>before-fmw-install</code></td>
<td>Intermediate (WLS_BUILD)</td>
<td>Before the Oracle Home is created.</td>
</tr>
<tr>
<td><code>after-fmw-install</code></td>
<td>Intermediate (WLS_BUILD)</td>
<td>After all of the Oracle middleware installers are finished.</td>
</tr>
<tr>
<td><code>final-build-commands</code></td>
<td>Final image</td>
<td>After all Image Tool actions are complete, and just before the Docker image is finalized.</td>
</tr>
</tbody>
</table>
<p>NOTE: Changes made in intermediate stages may not be carried forward to the final image unless copied manually.<br>
The Image Tool will copy the Java Home and the Oracle Home directories to the final image.<br>
Changes fully contained within these directories do not need an additional <code>COPY</code> command in the <code>final-build-commands</code> section.
Each section can contain one or more valid Dockerfile commands and would look like the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#f92672">[</span>after-fmw-install<span style="color:#f92672">]</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> rm /some/dir/unnecessary-file<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> --chown<span style="color:#f92672">=</span>oracle:oracle files/my_additional_file.txt /u01<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#f92672">[</span>final-build-commands<span style="color:#f92672">]</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> owner<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;middleware team&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><h4 id="--additionalbuildfiles"><code>--additionalBuildFiles</code></h4>
<p>This option provides a way to supply additional files to the image build command.
All provided files and directories are copied directly under the <code>files</code> subfolder of the build context.<br>
To get those files into the image, additional build commands must be provided using the <code>additionalBuildCommands</code> options.
Access to these files using a build command, such as <code>COPY</code> or <code>ADD</code>, should use the original filename
with the folder prefix, <code>files/</code>.  For example, if the
original file was provided as <code>--additionalBuildFiles /scratch/test1/convenience.sh</code>, the Docker build command <code>COPY</code>
provided in <code>--additionalBuildCommands</code> should look like
<code>COPY --chown=oracle:oracle files/convenience.sh /my/internal/image/location</code>.<br>
Because Image Tool uses multi-stage
builds, it is important to place the build command (like <code>COPY</code>) in the appropriate section of the <code>Dockerfile</code> based
on when the build needs access to the file.  For example, if the file is needed in the final image and not for
installation or domain creation steps, use the <code>final-build-commands</code> section so that the <code>COPY</code> command occurs in the
final stage of the image build.  Or, if the file needs to change the Oracle Home prior to domain creation, use
the <code>after-fmw-install</code> or <code>before-wdt-command</code> sections.</p>
<h4 id="use-an-argument-file">Use an argument file</h4>
<p>You can save all arguments passed for the Image Tool in a file, then use the file as a parameter.</p>
<p>For example, create a file called <code>build_args</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rebase
--tag wls:122140
--sourceImage wls:122130
--version 12.2.1.4.0
--jdkVersion 8u221
</code></pre></div><p>Use it on the command line, as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">imagetool @/path/to/build_args
</code></pre></div><h2 id="usage-scenarios">Usage scenarios</h2>
<p><strong>Note</strong>: Use <code>--passwordEnv</code> or <code>--passwordFile</code> instead of <code>--password</code>.</p>
<p>The commands below assume that all the required JDK, WLS, or FMW (WebLogic infrastructure installers) have been downloaded
to the cache directory. Use the <a href="cache.md">cache</a> command to set it up.</p>
<ul>
<li>
<p>Update the JDK for an existing domain.  Copy the existing domain from <code>sample:v1</code> where the JDK was 8u202 to a new
image called <code>sample:v2</code> and install the newer JDK 8u221 with WebLogic Server 12.2.1.3.0.</p>
<pre><code>imagetool rebase --tag sample:v2 --sourceImage sample:v1 --version 12.2.1.3.0 --jdkVersion 8u221 
</code></pre></li>
<li>
<p>Update the Oracle Home for an existing domain with a newer WebLogic version.  Copy a domain from an existing image to
a new image with a new install of WebLogic Server 12.2.1.4.0.  Copy the domain
from <code>sample:v1</code> and select the desired WebLogic installer using the <code>--version</code> argument.</p>
<pre><code>imagetool rebase --tag sample:v2 --sourceImage sample:v1 --version 12.2.1.4.0 --jdkVersion 8u221 
</code></pre></li>
<li>
<p>Update the JDK and/or Oracle Home for an existing domain using another image with pre-installed binaries.
Copy the domain from the source image named <code>sample:v1</code> to a new image called <code>sample:v2</code> based on a target image
named <code>fmw:12214</code>.  <strong>Note</strong>: The Oracle Home and JDK must be installed in the same same folders on each image.</p>
<pre><code>imagetool rebase --tag sample:v2 --sourceImage sample:v1 --targetImage fmw:12214
</code></pre></li>
</ul>
<h2 id="copyright">Copyright</h2>
<p>Copyright (c) 2019, 2021, Oracle and/or its affiliates.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
            
        

        


	 
	 
		
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/weblogic-image-tool/js/clipboard.min.js?1619704376"></script>
    <script src="/weblogic-image-tool/js/perfect-scrollbar.min.js?1619704376"></script>
    <script src="/weblogic-image-tool/js/perfect-scrollbar.jquery.min.js?1619704376"></script>
    <script src="/weblogic-image-tool/js/jquery.sticky.js?1619704376"></script>
    <script src="/weblogic-image-tool/js/featherlight.min.js?1619704376"></script>
    <script src="/weblogic-image-tool/js/highlight.pack.js?1619704376"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/weblogic-image-tool/js/modernizr.custom-3.6.0.js?1619704376"></script>
    <script src="/weblogic-image-tool/js/learn.js?1619704376"></script>
    <script src="/weblogic-image-tool/js/hugo-learn.js?1619704376"></script>
    
        
            <script src="/weblogic-image-tool/mermaid/mermaid.js?1619704376"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

